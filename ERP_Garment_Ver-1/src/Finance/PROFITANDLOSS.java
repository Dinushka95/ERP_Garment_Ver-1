
package Finance;

import MainSystem.AutoDB_Connect;
import static MainSystem.AutoDB_Connect.DB_connection;
import static MainSystem.MainWindow.autoSqlQuery;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import javax.swing.JTextField;




/**
 *
 * @author Dinushka
 */
public class PROFITANDLOSS extends javax.swing.JInternalFrame {

    private float closeship;
    private float goods;
    private float cos;
    private float costsales;
    private JTextField gross;



    /**
     * Creates new form SalesDesignInquiry
     */
    public PROFITANDLOSS() {
        initComponents();
        CalAnnualSales();
        CalcSalesRetuen();
        CalcCostofSales();
        CalPurchase();
        CalReturnPurchase();
        CalcCostOfSales();
        CalcGrossProfit();
        CalcExpencess();
       
        
      
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jTabbedPane1 = new javax.swing.JTabbedPane();
        jPanel1 = new javax.swing.JPanel();
        jPanel6 = new javax.swing.JPanel();
        jLabel4 = new javax.swing.JLabel();
        jLabel5 = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();
        jLabel8 = new javax.swing.JLabel();
        Sales = new javax.swing.JTextField();
        SalesReturn = new javax.swing.JTextField();
        jLabel9 = new javax.swing.JLabel();
        jLabel10 = new javax.swing.JLabel();
        jLabel11 = new javax.swing.JLabel();
        jLabel13 = new javax.swing.JLabel();
        jLabel16 = new javax.swing.JLabel();
        jLabel17 = new javax.swing.JLabel();
        Clossing = new javax.swing.JTextField();
        jButton1 = new javax.swing.JButton();
        CostOfSales = new javax.swing.JTextField();
        openStock = new javax.swing.JTextField();
        Purchase = new javax.swing.JTextField();
        ReturnPuechase = new javax.swing.JTextField();
        Goods = new javax.swing.JTextField();
        jLabel19 = new javax.swing.JLabel();
        CostSales = new javax.swing.JTextField();
        jLabel20 = new javax.swing.JLabel();
        GrossProfit = new javax.swing.JTextField();
        jLabel21 = new javax.swing.JLabel();
        Expen = new javax.swing.JTextField();
        jLabel22 = new javax.swing.JLabel();
        net = new javax.swing.JTextField();
        jLabel23 = new javax.swing.JLabel();
        Shipping = new javax.swing.JTextField();
        jLabel24 = new javax.swing.JLabel();
        Tax = new javax.swing.JTextField();
        jLabel26 = new javax.swing.JLabel();
        jTextField20 = new javax.swing.JTextField();
        jButton11 = new javax.swing.JButton();
        jButton2 = new javax.swing.JButton();
        datePicker1 = new com.github.lgooddatepicker.components.DatePicker();
        datePicker2 = new com.github.lgooddatepicker.components.DatePicker();

        setResizable(true);
        setTitle("Bank Details");
        setMaximumSize(new java.awt.Dimension(1365, 620));
        setMinimumSize(new java.awt.Dimension(1365, 620));
        setPreferredSize(new java.awt.Dimension(1365, 620));
        getContentPane().setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jTabbedPane1.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N

        jPanel1.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jPanel6.setBorder(javax.swing.BorderFactory.createEtchedBorder());
        jPanel6.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jLabel4.setText("Sales");
        jLabel4.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jPanel6.add(jLabel4, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 50, 80, -1));

        jLabel5.setText("(-)Sales Returns");
        jLabel5.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jPanel6.add(jLabel5, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 80, 140, -1));

        jLabel6.setText("Date");
        jLabel6.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jPanel6.add(jLabel6, new org.netbeans.lib.awtextra.AbsoluteConstraints(210, 10, 40, -1));

        jLabel8.setText("To");
        jLabel8.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jPanel6.add(jLabel8, new org.netbeans.lib.awtextra.AbsoluteConstraints(420, 10, 30, -1));
        jPanel6.add(Sales, new org.netbeans.lib.awtextra.AbsoluteConstraints(360, 40, 130, -1));
        jPanel6.add(SalesReturn, new org.netbeans.lib.awtextra.AbsoluteConstraints(360, 70, 130, -1));

        jLabel9.setText("Cost Of Sales");
        jLabel9.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jPanel6.add(jLabel9, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 110, 140, -1));

        jLabel10.setText("Opening Stock");
        jLabel10.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jPanel6.add(jLabel10, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 140, 150, -1));

        jLabel11.setText("Cost Of Goods Available For Sale ");
        jLabel11.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jPanel6.add(jLabel11, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 230, 210, -1));

        jLabel13.setText("Purchase Returns");
        jLabel13.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jPanel6.add(jLabel13, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 200, 110, -1));

        jLabel16.setText("(+)Purchases");
        jLabel16.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jPanel6.add(jLabel16, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 170, 90, -1));

        jLabel17.setText("(-)Closing Stock");
        jLabel17.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jPanel6.add(jLabel17, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 260, 110, -1));

        Clossing.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                ClossingKeyReleased(evt);
            }
        });
        jPanel6.add(Clossing, new org.netbeans.lib.awtextra.AbsoluteConstraints(210, 260, 130, -1));

        jButton1.setText("ADD");
        jButton1.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jPanel6.add(jButton1, new org.netbeans.lib.awtextra.AbsoluteConstraints(170, 500, 70, -1));
        jPanel6.add(CostOfSales, new org.netbeans.lib.awtextra.AbsoluteConstraints(360, 100, 130, -1));

        openStock.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                openStockKeyReleased(evt);
            }
        });
        jPanel6.add(openStock, new org.netbeans.lib.awtextra.AbsoluteConstraints(210, 140, 130, -1));
        jPanel6.add(Purchase, new org.netbeans.lib.awtextra.AbsoluteConstraints(210, 170, 130, -1));
        jPanel6.add(ReturnPuechase, new org.netbeans.lib.awtextra.AbsoluteConstraints(210, 200, 130, -1));
        jPanel6.add(Goods, new org.netbeans.lib.awtextra.AbsoluteConstraints(210, 230, 130, -1));

        jLabel19.setText("Cost Of Sales");
        jLabel19.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jPanel6.add(jLabel19, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 320, 100, -1));
        jPanel6.add(CostSales, new org.netbeans.lib.awtextra.AbsoluteConstraints(370, 310, 130, -1));

        jLabel20.setText("Gross Profit/Loss");
        jLabel20.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jPanel6.add(jLabel20, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 350, 140, -1));
        jPanel6.add(GrossProfit, new org.netbeans.lib.awtextra.AbsoluteConstraints(370, 340, 130, -1));

        jLabel21.setText("Expences");
        jLabel21.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jPanel6.add(jLabel21, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 370, 80, -1));
        jPanel6.add(Expen, new org.netbeans.lib.awtextra.AbsoluteConstraints(210, 370, 130, -1));

        jLabel22.setText("Net Profit/Loss");
        jLabel22.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jPanel6.add(jLabel22, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 400, 100, -1));
        jPanel6.add(net, new org.netbeans.lib.awtextra.AbsoluteConstraints(370, 390, 130, -1));

        jLabel23.setText("Shipping Cost");
        jLabel23.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jPanel6.add(jLabel23, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 290, 100, -1));

        Shipping.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                ShippingKeyReleased(evt);
            }
        });
        jPanel6.add(Shipping, new org.netbeans.lib.awtextra.AbsoluteConstraints(210, 290, 130, -1));

        jLabel24.setText("10% of IncomeTax");
        jLabel24.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jPanel6.add(jLabel24, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 430, 120, -1));
        jPanel6.add(Tax, new org.netbeans.lib.awtextra.AbsoluteConstraints(370, 420, 130, -1));

        jLabel26.setText("Net Profit/Loss Per Year");
        jLabel26.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jPanel6.add(jLabel26, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 460, 180, -1));
        jPanel6.add(jTextField20, new org.netbeans.lib.awtextra.AbsoluteConstraints(370, 450, 130, -1));

        jButton11.setText("Genarate a Report");
        jButton11.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jPanel6.add(jButton11, new org.netbeans.lib.awtextra.AbsoluteConstraints(260, 500, 150, -1));

        jButton2.setText("Demo");
        jButton2.setFont(new java.awt.Font("Times New Roman", 1, 14)); // NOI18N
        jPanel6.add(jButton2, new org.netbeans.lib.awtextra.AbsoluteConstraints(560, 500, -1, -1));
        jPanel6.add(datePicker1, new org.netbeans.lib.awtextra.AbsoluteConstraints(250, 0, 150, 30));
        jPanel6.add(datePicker2, new org.netbeans.lib.awtextra.AbsoluteConstraints(470, 0, 150, 30));

        jPanel1.add(jPanel6, new org.netbeans.lib.awtextra.AbsoluteConstraints(330, 0, 650, 550));

        jTabbedPane1.addTab("PROFIT AND LOSS", jPanel1);

        getContentPane().add(jTabbedPane1, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 0, 1350, 580));

        getAccessibleContext().setAccessibleName("");

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void openStockKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_openStockKeyReleased
        // TODO add your handling code here:
        Goods.setText("");
        CalcCostofGoddsSales();
        
    }//GEN-LAST:event_openStockKeyReleased

    private void ClossingKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_ClossingKeyReleased
        // TODO add your handling code here:
        CalcClosingShipping();
    }//GEN-LAST:event_ClossingKeyReleased

    private void ShippingKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_ShippingKeyReleased
        // TODO add your handling code here:
        CalcClosingShipping();
    }//GEN-LAST:event_ShippingKeyReleased

 private void CalAnnualSales()
 {
         try {
             PreparedStatement statement  =DB_connection.prepareStatement("SELECT SUM(total) from garmentsystem.d_salesInvoice_table;");
             ResultSet  results = statement.executeQuery();
                results.next();
                String sum = results.getString(1);
                System.out.println(sum);
                Sales.setText(sum);
            }
            
            catch (SQLException ex) 
                
             {
                System.out.println(ex.getMessage());
            }
     }
 
 private void CalcSalesRetuen()
 {
     try {
             PreparedStatement statement  =DB_connection.prepareStatement("SELECT SUM(TotalAmount) from garmentsystem.d_salesReturn_table;");
             ResultSet  results = statement.executeQuery();
                results.next();
                String sum = results.getString(1);
                System.out.println(sum);
                SalesReturn.setText(sum);
            }
            
            catch (SQLException ex) 
                
             {
                System.out.println(ex.getMessage());
            }
 }
 
  private void CalcCostofSales()
  {
      float sales = Float.parseFloat(Sales.getText());
      float ret   = Float.parseFloat(SalesReturn.getText());
   
      
      float cos = (sales-ret);
      System.out.println(cos);
      CostOfSales.setText(Double.toString(cos));
  }
 
 private void CalPurchase()
 {
         try {
             PreparedStatement statement  =DB_connection.prepareStatement("SELECT SUM(Total) FROM garmentsystem._PurchasesRecieved;");
             ResultSet  results = statement.executeQuery();
                results.next();
                String sum = results.getString(1);
                System.out.println(sum);
                Purchase.setText(sum);
            }
            
            catch (SQLException ex) 
                
             {
                System.out.println(ex.getMessage());
            }
     }
 
  private void CalReturnPurchase()
 {
         try {
             PreparedStatement statement  =DB_connection.prepareStatement("SELECT SUM(TotalAmount) FROM garmentsystem.PurchaseReturn;");
             ResultSet  results = statement.executeQuery();
                results.next();
                String sum = results.getString(1);
                System.out.println(sum);
                ReturnPuechase.setText(sum);
            }
            
            catch (SQLException ex) 
                
             {
                System.out.println(ex.getMessage());
            }
     }
 
   private void CalcCostofGoddsSales()
 {
       float open = Float.parseFloat(openStock.getText());
       float Purch = Float.parseFloat(Purchase.getText());
        float Purchre = Float.parseFloat(ReturnPuechase.getText());
       
      float goods = (open+Purch+Purchre);

       System.out.println(goods);
      Goods.setText(Double.toString(goods));
     }
   
   
  private void CalcClosingShipping()
 {
       float clossing = Float.parseFloat(Clossing.getText());
       float shipping = Float.parseFloat(Shipping.getText());
       
        float closeship = (clossing+shipping);
        System.out.println(closeship);
     }
   
  
   private void CalcCostOfSales()
 {
        //float closeship = 0;
     float costsales = (goods-closeship);
      System.out.println(costsales);
      
      CostSales.setText(Double.toString(costsales));
       
        System.out.println(costsales);
     }
    private void CalcGrossProfit()
 {
        //float closeship = 0;
        float gross = (cos-costsales);
      System.out.println(gross);
      
      GrossProfit.setText(Double.toString(gross));
       
        System.out.println(gross);
     }
    
  
    private void CalcExpencess()
 {
         try {
             PreparedStatement statement  =DB_connection.prepareStatement("SELECT SUM(Amount) FROM garmentsystem.F_EXPENES;");
             ResultSet  results = statement.executeQuery();
                results.next();
                String sum = results.getString(1);
                System.out.println(sum);
                Expen.setText(sum);
            }
            
            catch (SQLException ex) 
                
             {
                System.out.println(ex.getMessage());
            }
     }
    
    //----------NetProfit Calculate----------------
   /*  private void CalcNetProfit()
 {
     
       float ex = Float.parseFloat(Expen.getText());
       
        float Net = (gross-ex);
  
      
      net.setText(Double.toString(Net));
       
        System.out.println(Net);
     }
    */
    
    //----------------taxCalculate-------------------
  /* private void Calctax()
 {
          
         float rate = (float) 0.10;       
        float tax = (Net*rate);
        
        net.setText(Double.toString(tax));
       
        System.out.println(tax);
        
     }
  */
   //-----------------netProfit per year------------- 
    /*
     private void CalcNetProfitperYear()
 {
       
        float peryear = (Net-tax);
  
      
      net.setText(Double.toString(peryear));
       
        System.out.println(peryear);
     }
    */
    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JTextField Clossing;
    private javax.swing.JTextField CostOfSales;
    private javax.swing.JTextField CostSales;
    private javax.swing.JTextField Expen;
    private javax.swing.JTextField Goods;
    private javax.swing.JTextField GrossProfit;
    private javax.swing.JTextField Purchase;
    private javax.swing.JTextField ReturnPuechase;
    private javax.swing.JTextField Sales;
    private javax.swing.JTextField SalesReturn;
    private javax.swing.JTextField Shipping;
    private javax.swing.JTextField Tax;
    private com.github.lgooddatepicker.components.DatePicker datePicker1;
    private com.github.lgooddatepicker.components.DatePicker datePicker2;
    private javax.swing.JButton jButton1;
    private javax.swing.JButton jButton11;
    private javax.swing.JButton jButton2;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel13;
    private javax.swing.JLabel jLabel16;
    private javax.swing.JLabel jLabel17;
    private javax.swing.JLabel jLabel19;
    private javax.swing.JLabel jLabel20;
    private javax.swing.JLabel jLabel21;
    private javax.swing.JLabel jLabel22;
    private javax.swing.JLabel jLabel23;
    private javax.swing.JLabel jLabel24;
    private javax.swing.JLabel jLabel26;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel6;
    private javax.swing.JTabbedPane jTabbedPane1;
    private javax.swing.JTextField jTextField20;
    private javax.swing.JTextField net;
    private javax.swing.JTextField openStock;
    // End of variables declaration//GEN-END:variables

   
  

  

   
}
